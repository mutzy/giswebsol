<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]>      <html class="no-js"> <!--<![endif]-->

<html>
  {% load static %}
 
    <head>
      

        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title> GIS Web Solution | Dashboard</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!--Favicon-->
        <link rel=icon href="{% static '/img/favicon.ico' %}" sizes="16x16">
        <!-- Font Awesome CSS -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
rel="stylesheet"
integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN"
crossorigin="anonymous"
>
        <!--Roboto font-->
        <link rel="dns-prefetch" href="//fonts.gstatic.com">
        
        <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed&display=swap" rel="stylesheet">
        <!--Bootstrap-->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
        <!--Open Map Css-->
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
crossorigin=""/>    
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">  
<link rel="stylesheet" type="text/css" href="http://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/0.4.0/MarkerCluster.css" />
<link rel="stylesheet" type="text/css" href="http://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/0.4.0/MarkerCluster.Default.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.0.3/dist/MarkerCluster.css">

        <!--Custom css-->
      
        <link rel="stylesheet" href="{% static 'css/app.css' %}">   
</head>
    <body>
        <style>

            #resizable { height: 505px; padding: 0; }
            .list-group {    
              max-height: 200px;
              padding: 0;
              margin-bottom: 10px;
              overflow-y:auto;
              -webkit-overflow-scrolling: touch;
            }
            #ami {    
              max-height: 200px;
              padding: 1px;
              margin-bottom: 10px;
              overflow-y:auto;
              -webkit-overflow-scrolling: touch;
            }
            #disp {
              padding: 1px;
            }
            .custom-file-input{
              bottom: 5px;
              right: 2px;
              left: 18px;
            }
            .custom-file-label{
              top: 60px;
              bottom: 5px;
              right: 2px;
              left: 18px;
            }
                    
        </style>
        <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="#">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
        <div id="app">
            <nav class="navbar navbar-expand-md navbar-dark bg-dark sticky-top shadow-sm">
                <div class="container-fluid">
                    <a class="navbar-brand" href="/">
                      <img src="{% static 'img/logo.png' %}" width="30" height="30" class="d-inline-block align-top" alt="" loading="lazy">
                        GIS Web Solution <small style="font-size: 9px;"> [v1.1.0]</small>
                    </a>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
    
                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <!-- Left Side Of Navbar -->
                        <ul class="navbar-nav mr-auto">
                               
                        </ul>
                        {% load icons %}
                        <!-- Right Side Of Navbar -->
                        <ul class="navbar-nav ml-auto">
                            <!-- Authentication Links -->
                            {% if user.is_authenticated %}
                            <li class="nav-item dropdown ">
                              <a class="nav-link dropdown-toggle text-white " href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <span id="ai"></span>&nbsp;<span class="font-weight-bold fs-2 pr-2"> {{ user.username | title }}!</span>  {% icon 'profile' %}
                              </a>
                              <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                                
                                <a class="dropdown-item font-weight-bold text-danger " href="{% url 'logout' %}">{% icon 'logout'%} Logout</a>
                              </div>
                            </li>
                            {% endif %}                           
                        </ul>
                    </div>
                </div>
            </nav>
    
        <main class="py-2">
{% block content %}

{% endblock content %}
</main>

<div class="footer text-center fixed-bottom">
{% block footer %}
<div class="footer mb-0 text-sm-right col-12 text-wrap pt-3 pr-0 pl-0" style="font-size: 9px;" id="3b3b" >[v1.1.0 - beta]</div>
{% endblock %}
</div>
</div>

<!-- The Modal -->
<div class="modal" id="modal1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">Add Crime Data</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
      <div class="row">
         <div class="col-6 border-right-1 border-dark">
          <p>Manual Data Input</p>
          <form method="post" id="ami" action="/my_form/">
            {% csrf_token %}  
            <div class="form-group">
              <label for="country">Country</label>
              <input type="text" class="form-control form-control-sm" id="country" name="country" placeholder="Country">
            </div>
            <div class="form-group">
              <label for="province">Province</label>
              <input type="text" class="form-control form-control-sm" id="province" name="province" placeholder="Province">
            </div>
            <div class="form-group">
                <label for="hour">Hour</label>
                <input type="number" class="form-control form-control-sm" id="hour" name="hour" placeholder="Hour">
              </div>
              <div class="form-group">
                <label for="minutes">Minutes</label>
                <input type="number" class="form-control form-control-sm" id="minutes" name="minutes" placeholder="Minutes">
              </div>
              <div class="form-group">
                <label for="period">Period</label>
                <input type="text" class="form-control form-control-sm" id="period" name="period" placeholder="(Format = AM/PM)">
              </div>
                  <div class="form-group">
                    <label for="latitude">Latitude</label>
                    <input type="text" class="form-control form-control-sm" id="latitude" name="latitude" placeholder="Latitude">
                  </div>
                  <div class="form-group">
                    <label for="longtitude">Longtitude</label>
                    <input type="text" class="form-control form-control-sm" id="longtitude" name="longtitude" placeholder="Longtitude">
                  </div>
                  <div class="form-group">
                    <label for="narrative">Narrative</label>
                    <textarea class="form-control" id="narrative" name="narrative" rows="3" placeholder="Narrative"></textarea>
                  </div>
                  <button type="submit" class="btn btn-primary">Add Incident</button>                          
          </form>
         </div>
         <div class="col-6">
          <p>File Upload[Formats: "xlsx xls csv"]</p>
          <form method="post" enctype="multipart/form-data" action="/file_alt/" >
            {% csrf_token %}     
            <div class="form-group">   
            <input type="file" name="file_alt" id="file_alt" class="form-control-file-sm custom-file-input">
            <label class="custom-file-label" for="file_alt">Choose File</label>
            </div>
            <button type="submit" name="submit" class="btn btn-primary mt-2">Upload File</button>
        </form>
         </div>
      </div>
      </div>

      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
      </div>

    </div>
  </div>
</div>


<!-- The Modal -->
<div class="modal" id="modal2">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">Search Information Overview by Country, Province and Narrative</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
       <div class="row">
         <div class="col-6">
           <p>Search by Country, Province and Narrative</p>
           <div id="view_crime_info">
           <div class="form-group" id="category"> 
            <input type="text" name="search_alt" id="search_alt" class="form-control-input  form-control-sm" style="width:100%; " placeholder="Search by Location or Crime">
          </div>
        </div>
         </div>
         <div class="col-6">
          <p>Query Result Overview</p>
          <div  id="location_info_alt">
          {% include 'snippets/display.html' %} 
        </div>
         </div>
       </div>
      </div>

      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
      </div>

    </div>
  </div>
</div>

<!-- The Modal -->
<div class="modal" id="modal3">
  <div class="modal-dialog modal-sm ml-0 mb-auto">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header pt-1 pb-1">
        <p class="modal-title">Map Visual Search</p>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>

      <!-- Modal body -->
      <div class="modal-body pt-1 pb-1">
        <div class="form-group" id="category"> 
          <input type="text" name="marker_search_alt" id="marker_search_alt" class="form-control-input  form-control-sm" style="width:100%; " placeholder="Search by Location or Crime">
        </div>
      </div>
    </div>
  </div>
</div>

<!--jQuery, Popper.js, and Bootstrap JS-->
{% block javascript %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
<!--Open Map JS-->
<script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
  integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
  crossorigin=""></script>
  <script src="https://unpkg.com/leaflet.markercluster@1.3.0/dist/leaflet.markercluster.js"></script>
  <script src='https://unpkg.com/leaflet.markercluster@1.3.0/dist/leaflet.markercluster-src.js'></script>
  
  <!--  <script src="https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/leaflet.markercluster.js"></script>
Custom JS-->
    <script src="{% static 'js/functions.js' %}"></script>

    <script src="{% static 'js/search.js' %}"></script>
    <script src="{% static 'js/moment.min.js' %}"></script>
    <script src="{% static 'js/combodate.js' %}"></script>

            
    <script>

       
        //marker.bindPopup("<b>Dropped Ping!</b><br>lat:"+lat+"long:"+lng).openPopup();
        
        </script>
      <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
      <script type='text/javascript'>
       // Add the following code if you want the name of the file appear on select
      $(".custom-file-input").on("change", function() {
        var fileName = $(this).val().split("\\").pop();
        $(this).siblings(".custom-file-label").addClass("selected").html(fileName);
      });

      let markersLayer = L.markerClusterGroup();

      mymap.addLayer(markersLayer);


      function populateMap() {
          
            let lat = data.latitude;
            let lng = data.longitude;

            let marker = L.marker([lat, lng]).addTo(mymap);
            markersLayer.addLayer(marker);
          
      }
    
    //  populateMap(arg);

     
      </script>
      {% endblock javascript %}
    </body>
</html>